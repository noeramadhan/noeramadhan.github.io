<!doctype html>
<html>

<head>
    <title>///</title>
    <meta charset="UTF-8">
    <meta http-equiv="cache-control" content="private,max-age=0,no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="///">
    <meta name="apple-mobile-web-app-title" content="///">
    <meta name="msapplication-starturl" content="/">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
    <style>
        html {
            height: 100vh;
        }
        body{
        	font-size: 16px;
        }
        
        .app {
            max-width: 650px;
            height: 100%;
        }
        
        * {
            font-family: 'Helvetica', sans-serif !important;
            font-display: swap;
			text-rendering: optimizeLegibility;
			font-feature-settings: "kern";
			-webkit-font-feature-settings: "kern";
			-moz-font-feature-settings: "kern";
			-moz-font-feature-settings: "kern=1";
        }
        
        a {
            color: black;
        }
        
        a:hover {
            color: black;
            text-decoration: none;
            border-bottom: .5px black solid;
        }
        section.content p{
        	max-width: 60ch;
        	font-size: 18px !important;
        	line-height: 1.7rem !important;
            letter-spacing: -.04rem;
        }
        header.header{
        	font-size: 4rem;
            letter-spacing: -.3rem;
        }
        .list-title{
        	font-size: 1.1rem;
            line-height: 1.5rem !important;
            letter-spacing: -.05rem;
        }
        .list-date{
        	font-size: .9rem;
            letter-spacing: -.05rem;
        }
        .article-title{
			font-size: 2.25rem;
			line-height: 2.25rem !important;
            letter-spacing: -.15rem;
        }
        .article-date{
			font-size: .9rem;
            letter-spacing: -.05rem;
        }
    </style>
    <script type="text/javascript">
        WebFontConfig = {
            google: {
                families: ['Roboto']
            }
        };
        (function() {
            var wf = document.createElement('script');
            wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
            wf.type = 'text/javascript';
            wf.async = 'true';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(wf, s);
        })();
    </script>
</head>

<body onload="onLoadAsync()">
    <div class="app mx-auto">
        <div class="card card-body p-0 px-3 pb-5 m-0 border-0">
            <header class="header text-center p-3 mb-4">
            		<a href="#"><span class="font-weight-bold">///</span></a>
            </header>
            <section class="content container pt-0 mt-0 mb-2"></section>
        </div>
    </div>
    <script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.15.0/umd/popper.min.js" async></script>
    <script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js" async></script>
    <script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.9.0/showdown.min.js" async></script>
    <script type="application/javascript">
        const APP_CDN = "https://cdn.jsdelivr.net/gh/noeramadhan/noeramadhan.github.io@master/posts/",
            APP_BASE = "https://noeramadhan.github.io/posts/";
        $(document).ready(function() {
            route();
            $(window).on('hashchange', route);
        });

        function route() {
            document.getElementsByClassName('content')[0].innerHTML = "";
            location.hash ? read((location.hash).slice(1)) : list();
        }

        function read(name) {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', APP_CDN + name + '.md');
            xhr.onload = () => {
                if (xhr.status === 200) {
                    var converter = new showdown.Converter({
                            metadata: true
                        }),
                        data = xhr.responseText,
                        html = converter.makeHtml(data),
                        meta = converter.getMetadata();
                    if (meta['title'] !== undefined) {
                        document.getElementsByClassName('content')[0].innerHTML += '<h5 class="article-date text-muted text-center mb-2 pb-0 pt-0 mt-0">Posted on ' + meta['date'] + '</h5><h5 class="article-title font-weight-bold mt-0 pt-0 mb-5 text-center">' + meta['title'] + '</h5>';
                    }
                    document.getElementsByClassName('content')[0].innerHTML += html;
                    document.title = "/// | " + meta['title'];
                } else {
                    read("404");
                }
            };
            xhr.send();
        }

        function list() {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', APP_BASE + 'list.json');
            xhr.onload = () => {
                if (xhr.status === 200) {
                    var data = JSON.parse(xhr.responseText),
                        content = '';
                    data.posts.sort((a, b) => {
                        var dateA = a.date.split('/'),
                            dateB = b.date.split('/');
                        return new Date(dateB[2], dateB[1], dateB[0]).getTime() - new Date(dateA[2], dateA[1], dateA[0]).getTime();
                    });
                    data.posts.forEach((meta, key) => {
                        content += '<div class="row mb-3">' +
                        				'<div class="col">' +
                        					'<a class="list-title font-weight-bold" href="#' + meta['slug'] + '">' + 
                        							meta['title'] +
                        					'</a>' +
                        				'</div>' +
                        				'<div class="col list-date text-right text-muted">' +
                        					meta['date'] +
                        				'</div>' +
                        			'</div>';
                    });
                    document.getElementsByClassName('content')[0].innerHTML += content;
                    document.title = "///";
                }
            };
            xhr.send();
        }
        async function onLoadAsync() {
            if (navigator.serviceWorker) {
                try {
                    let serviceWorker = await navigator.serviceWorker.register('service.js')
                } catch (err) {
                    console.error(`Failed to register service worker: ${err}`)
                }
            }
        }
    </script>
</body>

</html>