var APP_PREFIX='noblog_',VERSION='version_01',CACHE_NAME=APP_PREFIX+VERSION,URLS=['/index.html','/android-chrome-192x192.png','/android-chrome-512x512.png','/apple-touch-icon.png','/favicon-16x16.png','/favicon-32x32.png','/favicon.ico','/site.webmanifest','/posts/list.json']self.addEventListener('fetch',(e)=>{console.log('fetch request : '+e.request.url)e.respondWith(caches.match(e.request).then((request)=>{if(request){return request}else{return fetch(e.request)}}))})self.addEventListener('install',(e)=>{e.waitUntil(caches.open(CACHE_NAME).then((cache)=>{return cache.addAll(URLS)}))})self.addEventListener('activate',(e)=>{e.waitUntil(caches.keys().then((keyList)=>{var cacheWhitelist=keyList.filter((key)=>{return key.indexOf(APP_PREFIX)})cacheWhitelist.push(CACHE_NAME)return Promise.all(keyList.map((key,i)=>{if(cacheWhitelist.indexOf(key)===-1){return caches.delete(keyList[i])}}))}))})